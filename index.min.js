var __awaiter=this&&this.__awaiter||function(e,t,n,r){function a(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function c(e){try{s(r.next(e))}catch(e){o(e)}}function i(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){e.done?n(e.value):a(e.value).then(c,i)}s((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,o&&(c=2&n[0]?o.return:n[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,n[1])).done)return c;switch(o=0,c&&(n=[2&n[0],c.value]),n[0]){case 0:case 1:c=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,o=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(c=s.trys,!(c=c.length>0&&c[c.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!c||n[1]>c[0]&&n[1]<c[3])){s.label=n[1];break}if(6===n[0]&&s.label<c[1]){s.label=c[1],c=n;break}if(c&&s.label<c[2]){s.label=c[2],s.ops.push(n);break}c[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],o=0}finally{a=c=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var a,o,c,i,s={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return i={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i},_this=this;__awaiter(_this,void 0,void 0,function(){function e(e){e.forEach(function(e){var t=document.createElement("li");t.className="list-item",t.style.cursor="pointer";var n=document.createElement("a");n.innerHTML=e.subcategory,t.appendChild(n);var r=document.createElement("div"),a=document.createElement("span");r.className="tags",a.innerHTML=e.category,r.appendChild(a),t.appendChild(r);var o=document.createElement("div");o.className="category-drugs hidden",t.appendChild(o),e.drugs.forEach(function(e){var t=document.createElement("div");t.className="drug-row";var n=document.createElement("h3");n.innerHTML=e.name,t.appendChild(n);var r=document.createElement("p");r.innerHTML=e.description,t.appendChild(r),o.appendChild(t)}),i.appendChild(t),t.addEventListener("click",function(){o.classList.toggle("hidden")})})}function t(e){e.forEach(function(e){var t=document.createElement("li");t.className="list-item";var n=document.createElement("a");n.innerHTML=e.name;var r=document.createElement("p");r.innerHTML=e.description;var a=document.createElement("div"),o=document.createElement("span");if(a.className="tags",o.innerHTML=e.category,a.appendChild(o),e.subcategory){var c=document.createElement("span");c.innerHTML=e.subcategory,a.appendChild(c)}t.appendChild(n),t.appendChild(a),t.appendChild(r),i.appendChild(t)})}function n(n,r){if(o.innerHTML="",i.innerHTML="",i.classList.remove("hidden"),"subcategory"===r){var a=[];n.forEach(function(e){e.classes.forEach(function(t){if(u(c.value,t.subcategory)){for(var n=[],r=0,o=t.drugs;r<o.length;r++){var i=o[r];n.push({name:i.name,description:i.description,subcategory:t.subcategory,category:e.category})}a.push({category:e.category,subcategory:t.subcategory,drugs:n})}})}),e(a)}else{var s=[];n.forEach(function(e){e.classes.forEach(function(t){t.drugs.forEach(function(n){u(c.value,n.name)&&s.push({name:n.name,description:n.description,subcategory:t.subcategory,category:e.category})})})}),t(s)}}function r(e){o.innerHTML="",i.classList.add("hidden"),e.forEach(function(e,t){var n=new h(e,t);n.setUp(),n.setUpSubCategories(),o.appendChild(n.getElement()),n.setEventListeners()})}function a(e,t){if(e){var a=t.filter(function(t){switch(s.id){case"category":return u(e,t.category);case"subcategory":return l(e,t);case"drug":return d(e,t);default:return!1}});"category"===s.id?r(a):n(a,s.id)}else r(t)}var o,c,i,s,u,l,d,h,g,p,f,m=this;return __generator(this,function(e){return o=document.getElementById("content"),c=document.querySelector("#search input"),i=document.querySelector("#search-output"),s=document.querySelector("input[name='filter'][checked]"),u=function(e,t){return t.toLowerCase().indexOf(e.toLocaleLowerCase())>-1},l=function(e,t){return t.classes.some(function(t){return!!t.subcategory&&u(e,t.subcategory)})},d=function(e,t){return t.classes.some(function(t){return t.drugs.some(function(t){return u(e,t.name)})})},h=function(){function e(e,t){this.category=document.createElement("li"),this.emlSection=e,this.index=t.toString(),this.clear()}return e.prototype.clear=function(){this.category.innerHTML=""},e.prototype.getElement=function(){return this.category},e.prototype.toggle=function(){this.category.classList.toggle("active")},e.prototype.setEventListeners=function(){var e=this,t=document.querySelectorAll(".category");this.categoryLink.onclick=function(n){n.stopPropagation(),t.forEach(function(t){t.id===e.category.id?(e.toggle(),t.querySelectorAll(".subcategory").forEach(function(e){e.classList.toggle("hidden")})):(t.classList.remove("active"),t.querySelectorAll(".subcategory").forEach(function(e){e.classList.add("hidden")}))})}},e.prototype.setUpSubCategories=function(){var e=this;this.emlSection.classes.forEach(function(t){var n=new g(t);n.addDrugs(),e.category.appendChild(n.getElement())}),this.setEventListeners()},e.prototype.setUp=function(){this.category.className="category",this.category.id=this.index,this.categoryLink=document.createElement("a"),this.categoryLink.innerHTML=this.emlSection.category,this.category.appendChild(this.categoryLink)},e}(),g=function(){function e(e){this.emlSectionClass=e,this.subcategory=document.createElement("ul"),this.subcategory.className="subcategory hidden",this.createHeader()}return e.prototype.createHeader=function(){this.header=document.createElement("h3"),this.header.className="subcategory__header",this.header.innerHTML=this.emlSectionClass.subcategory||"",this.subcategory.appendChild(this.header)},e.prototype.getElement=function(){return this.subcategory},e.prototype.addDrugs=function(){var e=this;this.emlSectionClass.drugs.forEach(function(t){var n=new p(t);e.subcategory.appendChild(n.getElement()),e.attachListeners()})},e.prototype.attachListeners=function(){var e=this;this.emlSectionClass.subcategory?this.header.onclick=function(t){t.stopPropagation();var n=e.subcategory.querySelectorAll(".drug__section");n.forEach(function(e){return e.classList.toggle("hidden")})}:this.header.remove()},e}(),p=function(){function e(e){this.drugSection=document.createElement("li"),this.drug=e,this.drugSection.className="drug__section",this.addDrugName(),this.addDrugDescription()}return e.prototype.addDrugName=function(){var e=document.createElement("h4");e.className="drug__name",e.innerHTML=this.drug.name,this.drugSection.appendChild(e)},e.prototype.addDrugDescription=function(){var e=document.createElement("p");e.className="drug__description",e.innerHTML=this.drug.description,this.drugSection.appendChild(e)},e.prototype.getElement=function(){return this.drugSection},e}(),f=function(){return __awaiter(m,void 0,void 0,function(){var e,t,n;return __generator(this,function(r){switch(r.label){case 0:return e="./src/eml-children-2017.json",[4,fetch(e,{headers:{"content-type":"application/json"}})];case 1:return t=r.sent(),t.ok?[4,t.json()]:[3,3];case 2:return n=r.sent(),[2,n];case 3:throw new Error("Unable to fetch EML data!")}})})},f().then(function(e){r(e),c.addEventListener("input",function(t){var n=t.target.value;a(n,e)}),document.getElementById("filter-form").onchange=function(t){s=t.target,a(c.value,e)}}).catch(function(e){console.log(e),o.innerHTML="There was an error loading the EML!"}),[2]})});